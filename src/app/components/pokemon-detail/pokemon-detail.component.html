<div
  class="pokedex-root"
  [ngStyle]="getTypeGradient(pokemon?.types)"
  [ngClass]="'type-' + (pokemon?.types?.[0]?.type?.name || 'normal')"
>
  <div class="pokedex-frame" *ngIf="!loading && pokemon; else loadingTpl">
    <button class="back-btn" (click)="goHome()" title="Volver al inicio">
      <i class="fa fa-arrow-left"></i> Volver
    </button>
    <!-- PANEL IZQUIERDO -->
    <aside class="pokedex-side" style="padding-top: 70px">
      <!-- Datos básicos y nombre -->
      <div class="pokemon-name">
        <h1>{{ pokemon.name | capitalize }}</h1>
      </div>
      <div class="pokedex-sprite">
        <img
          [src]="pokemon.sprites.front_default || 'assets/no-image.png'"
          [alt]="pokemon.name"
          width="240"
          height="240"
        />
      </div>
      <p
        class="pokedex-desc"
        style="
          display: flex;
          align-items: center;
          gap: 16px;
          justify-content: center;
        "
      >
        <span
          title="Altura"
          style="display: flex; align-items: center; gap: 4px; cursor: help"
        >
          <i class="fa-solid fa-arrows-up-down"></i> {{ pokemon.height / 10 }} m
        </span>
        <span
          title="Peso"
          style="display: flex; align-items: center; gap: 4px; cursor: help"
        >
          <i class="fa-solid fa-weight-hanging" aria-hidden="true"></i>
          {{ pokemon.weight / 10 }} kg
        </span>
        <span
          title="Base Experience"
          style="display: flex; align-items: center; gap: 4px; cursor: help"
        >
          <svg
            width="18"
            height="18"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="10" />
            <path d="M12 6v6l4 2" />
          </svg>
          {{ pokemon.base_experience || 'N/A' }}
        </span>
      </p>
      <!-- Tipos -->
      <div class="type-list">
        <span
          *ngFor="let t of pokemon.types"
          class="type-chip"
          [ngClass]="'type-' + t.type.name"
        >
          {{ translateType(t.type.name) | capitalize }}
        </span>
      </div>
    </aside>

    <!-- PANEL DERECHO -->
    <section class="pokedex-content">
      <div class="pokedex-scroll">
        <!-- Estadísticas -->
        <div class="pokedex-card" *ngIf="pokemon.stats?.length">
          <h2>Estadísticas</h2>
          <div class="stat-list">
            <div class="stat" *ngFor="let s of pokemon.stats">
              <div class="label" [title]="getStatDescription(s.stat.name)">
                <i class="fa-solid" [class]="getStatIcon(s.stat.name)"></i>
                <span>{{ s.stat.name | capitalize }}</span>
              </div>
              <div class="bar">
                <i [style.width.%]="(s.base_stat / 200) * 100"></i>
              </div>
              <div class="value">{{ s.base_stat }}</div>
            </div>
          </div>
        </div>
        <!-- Evolutions y Shiny en la misma línea -->
        <div class="pokedex-row">
          <!-- Evoluciones -->
          <div class="pokedex-card" *ngIf="evolutions?.length">
            <h2 style="margin-bottom: 8px">Evoluciones</h2>
            <div class="evolution-list">
              <button
                *ngFor="let evo of evolutions"
                class="evolution"
                (click)="goToPokemon(evo.id, $event)"
                [disabled]="loading"
              >
                <img
                  [src]="evo.sprites.front_default || 'assets/no-image.png'"
                  [alt]="evo.name"
                  width="60"
                  height="60"
                  draggable="false"
                />
                {{ evo.name | capitalize }}
              </button>
            </div>
          </div>
          <!-- Sprite shiny -->
          <div class="pokedex-card" *ngIf="pokemon.sprites.front_shiny">
            <h2 style="margin-bottom: 8px">Forma shiny</h2>
            <div class="pokedex-sprite" style="height: 80px">
              <img
                [src]="pokemon.sprites.front_shiny"
                alt="Shiny {{ pokemon.name }}"
                width="60"
                height="60"
              />
            </div>
          </div>
        </div>
        <!-- Abilities y Notable Moves en la misma línea debajo -->
        <div class="pokedex-row">
          <!-- Habilidades -->
          <div class="pokedex-card" *ngIf="pokemon.abilities?.length">
            <h2 style="margin-bottom: 8px">Habilidades</h2>
            <div class="ability-list">
              <div
                class="ability"
                *ngFor="let ab of pokemon.abilities"
                [title]="ab.is_hidden ? 'Hidden ability' : 'Ability'"
              >
                {{ ab.ability.name | capitalize }}
                <small *ngIf="ab.is_hidden" style="color: var(--muted)">
                  (hidden)</small
                >
              </div>
            </div>
          </div>
          <!-- Movimientos -->
          <div class="pokedex-card" *ngIf="pokemon.moves?.length">
            <h2 style="margin-bottom: 8px">Movimientos importantes</h2>
            <div class="ability-list">
              <div
                class="ability"
                *ngFor="let mv of pokemon.moves | slice : 0 : 4"
                [title]="mv.move.name"
              >
                {{ mv.move.name | capitalize }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Template de carga -->
  <ng-template #loadingTpl>
    <div class="pokedex-frame">
      <div class="pokedex-content">
        <div
          class="pokedex-scroll"
          style="text-align: center; padding-top: 100px"
        >
          <h2>Cargando Pokémon...</h2>
        </div>
      </div>
    </div>
  </ng-template>
</div>
